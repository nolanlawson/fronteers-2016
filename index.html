<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Offline, progressive, and multithreaded: webapps of the future</title>

  <meta name="description" content="Offline, progressive, and multithreaded: webapps of the future">
  <meta name="author" content="Nolan Lawson">

  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

  <link rel="stylesheet" href="css/reveal.min.css">
  <link rel="stylesheet" href="css/theme/simple.css" id="theme">

  <!-- For syntax highlighting -->
  <link rel="stylesheet" href="lib/css/tomorrow.css">
  <link rel="stylesheet" href="index.css">

  <!-- If the query includes 'print-pdf', include the PDF print sheet -->
  <script>
    if (window.location.search.match(/print-pdf/gi)) {
      var link = document.createElement('link');
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = 'css/print/pdf.css';
      document.getElementsByTagName('head')[0].appendChild(link);
    }
  </script>
</head>

<body>

<div class="reveal">
  <div class="slides">
    <section>
      <h2>Offline, progressive, and multithreaded</h2>
      <h4>A peek at webapps of the future</h4>

      <h4>@nolanlawson</h4>
    </section>

    <section>
      <img class="no-border" src="img/discostu.jpg" alt="Disco Stu looking at disco record sales"/>
      <div class="footer muted">Source: <a href="http://frinkiac.com/">Frinkiac</a></div>
    </section>

    <section>
      <img class="no-border" src="img/profile.jpg" alt="Nolan profile"/>
      <h4>@nolanlawson</h4>
    </section>

    <section data-background="img/edge.png">
    </section>

    <section>
      <div style="margin:0 auto;position:relative;width:500px;height:400px;background:url(img/grimacing.png) center center no-repeat;">
        <img style="position:absolute;bottom:0;left:150px;filter:" class="no-border" src="img/foot.png"/>
      </div>
    </section>

    <section>
      <h2 class="random-color">Progressive web apps!</h2>
    </section>

    <section data-background="img/hype_train.jpg">
    </section>

    <section>
      <div style="position:relative;width:471px;height:640px;margin:0 auto;">
        <img src="img/orion.jpg" width="471" height="640" style="position:absolute;left:0;right:0;top:0;bottom:0;"/>
        <img src="img/orion2.jpg" width="471" height="640" class="fragment" style="position:absolute;left:0;right:0;top:0;bottom:0;"/>
        <img src="img/orion3.jpg" width="471" height="640" class="fragment" style="position:absolute;left:0;right:0;top:0;bottom:0;"/>
        <img src="img/orion4.jpg" width="471" height="640" class="fragment" style="position:absolute;left:0;right:0;top:0;bottom:0;"/>
        <img src="img/orion5.jpg" width="471" height="640" class="fragment" style="position:absolute;left:0;right:0;top:0;bottom:0;"/>
        <img src="img/orion6.jpg" width="471" height="640" class="fragment" style="position:absolute;left:0;right:0;top:0;bottom:0;"/>
        <img src="img/orion7.jpg" width="471" height="640" class="fragment" style="position:absolute;left:0;right:0;top:0;bottom:0;"/>
      </div>
    </section>

    <section>
      <h4>Bruce Lawson on PWAs</h4>
      <img class="no-border" src="img/bruce_lawson.png" width="700"/>
      <div class="footer text-muted">
        Source: https://www.youtube.com/watch?v=YxQUxCsNomM
      </div>
    </section>

    <section>

      <blockquote class="speech bubble">
        HTML [is] in direct competition with other technologies intended
        for applications deployed over the web, in particular Flash and Silverlight.
      </blockquote>
      <div class="text-muted">
        <em>– Ian Hickson, 2009 (via Bruce Lawson)</em>
      </div>
    </section>


    <section>
      <img style="display:block;margin: 10px auto;" class="no-border" src="img/clipboard1.png"/>
      <img style="display:block;margin: 10px auto;" class="no-border" src="img/clipboard2.png"/>
    </section>

    <section data-background="img/alex_russell_future.png">
    </section>

    <section data-background="img/webnative_native_2x.png">
    </section>

    <section>

      <blockquote class="speech bubble">
        [The web] won on desktop, just in time for mobile to eat the world.
      </blockquote>
      <div class="text-muted">
        <em>– Alex Russell, 2016</em>
      </div>
    </section>

    <section>

      <table style="margin: 0 auto;" cellspacing="30">
        <thead>
        <tr>
          <th></th>
          <th><span>Native apps</span></th>
          <th><span>Web apps</span></th>
          <th><span class="fragment" data-fragment-index="12">PWAs</span></th>
        </tr>
        </thead>
        <tbody>
        <tr>
          <td><span class="fragment" data-fragment-index="1">&#x1f4f6; Offline</span></td>
          <td class="center"><span class="fragment" data-fragment-index="6">&#x2714;</span></td>
          <td class="center"><span class="fragment" data-fragment-index="7">&#x274C;</span></td>
          <td class="center"><span class="fragment" data-fragment-index="12">&#x2714;</span></td>
        </tr>
        <tr>
          <td><span class="fragment" data-fragment-index="2">&#x1F4C8; Progressive</span></td>
          <td class="center"><span class="fragment" data-fragment-index="8">&#x274C;</span></td>
          <td class="center"><span class="fragment" data-fragment-index="9">&#x2714;</span></td>
          <td class="center"><span class="fragment" data-fragment-index="12">&#x2714;</span></td>
        </tr>
        <tr>
          <td><span class="fragment" data-fragment-index="3">&#x1F419; Multithreaded</span></td>
          <td class="center"><span class="fragment" data-fragment-index="10">&#x2714;</span></td>
          <td class="center"><span class="fragment" data-fragment-index="11">&#x274C;</span></td>
          <td class="center"><span class="fragment" data-fragment-index="12">&#x2714;</span></td>
        </tr>
        </tbody>
      </table>

    </section>

    <section>
      <h2>&#x1f4f6; Offline</h2>
    </section>

    <section>
      <img style="margin:20px" class="no-border" src="img/pouchdb.png"/>
      <img style="margin:20px" class="no-border" src="img/localforage.png"/>
    </section>

    <section>
      <h3>Offline-first</h3>
    </section>

    <section>
      <blockquote class="speech bubble">
        We live in a disconnected and battery powered world, but our technology and best practices
        are a leftover from the always connected and steadily powered past.
      </blockquote>
      <div class="text-muted">
        <em>– offlinefirst.org</em>
      </div>
      <p></p>
    </section>

    <section data-background="img/jan.jpg">
    </section>

    <section>
      <h3>"Offline-first"</h3>
      <ul>
        <li class="fragment">Disconnected</li>
        <li class="fragment">Airplane mode</li>
        <li class="fragment">Lie-fi</li>
        <li class="fragment">Conference wifi</li>
        <li class="fragment">...negative mental associations</li>
      </ul>
    </section>

    <section>
      <h3>Offline-first is about <em>speed</em> &#x26A1;</h3>
    </section>

    <section>

      <div style="position:relative;width:918px;height:462px;margin: 0 auto;">
        <img style="position:absolute;left:0;right:0;top:0;bottom:0;z-index:1" class="" src="img/latency.png" alt="latency numbers all programmers should know"/>
        <img style="position:absolute;left:0;right:0;top:0;bottom:0;z-index:2"  class="fragment" src="img/latency-annotated.png" alt="latency numbers all programmers should know"/>
        <img style="position:absolute;left:0;right:0;top:0;bottom:0;z-index:3"  class="fragment" src="img/latency-annotated-2.png" alt="latency numbers all programmers should know"/>
        <img style="position:absolute;left:0;right:0;top:0;bottom:0;z-index:4"  class="fragment" src="img/latency-annotated-3.png" alt="latency numbers all programmers should know"/>
        <img style="position:absolute;left:0;right:0;top:0;bottom:0;z-index:5"  class="fragment" src="img/latency-annotated-4.png" alt="latency numbers all programmers should know"/>
        <img style="position:absolute;left:0;right:0;top:0;bottom:0;z-index:6"  class="fragment" src="img/latency-annotated-5.png" alt="latency numbers all programmers should know"/>
      </div>
          <span class="text-muted">
            https://gist.github.com/hellerbarde/2843375
          </span>
    </section>

    <section>
      <video src="vid/php.mp4" muted></video>
    </section>

    <section>
      <h3>How do we offline?</h3>
    </section>

    <section>

      <blockquote class="speech bubble">
        The web platform has always had two solutions to every problem: the deprecated one you shouldn't use and the one that's not yet ready.
      </blockquote>
      <div class="text-muted">
        <em>– Sylvain Galineau</em>
      </div>
    </section>

    <section>
      <table style="margin: 0 auto;" cellspacing="30">
        <thead>
        <tr>
          <th></th>
          <th><span>Ye olde way</span></th>
          <th><span>The hot &#x1F525; new way</span></th>
        </tr>
        </thead>
        <tbody>
        <tr>
          <td><span>Static data</span></td>
          <td class="center"><span class="fragment" data-fragment-index="2">AppCache</span></td>
          <td class="center"><span class="fragment" data-fragment-index="3">Cache API<br/>(Service Worker)</span></td>
        </tr>
        <tr>
          <td><span class="fragment" data-fragment-index="4">Dynamic/query data</span></td>
          <td class="center"><span class="fragment" data-fragment-index="5">LocalStorage,<br/>WebSQL</span></td>
          <td class="center"><span class="fragment" data-fragment-index="6">IndexedDB</span></td>
        </tr>
        </tbody>
      </table>
    </section>

    <section>
      <div style="height:800px;width:714px;position:relative;margin: 0 auto;transform:translateY(-10%);">
        <img class="no-border"
             style="position:absolute;top:0;bottom:0;left:0;right:0" src="img/pokedex_shot1.png"/>
        <img class="no-border fragment"
             style="position:absolute;top:0;bottom:0;left:0;right:0" src="img/pokedex_shot2.png"/>
        <img class="no-border fragment"
             style="position:absolute;top:0;bottom:0;left:0;right:0" src="img/pokedex_shot3.png"/>
      </div>
    </section>

    <section>
      <h2>&#x1F4C8; Progressive</h2>
    </section>

    <section>
      <h3>"Progressive enhancement"</h3>
      <ul>
        <li class="fragment"><strong>Weak version</strong>: gracefully degrade, progressively show content</li>
        <li class="fragment"><strong>Strong version</strong>: your site should work without JavaScript</li>
      </ul>
    </section>

    <section data-background="img/regressive.png" data-background-size="contain">
    </section>

    <section>
      <h3>In 2016, it's okay to build a website that doesn't work without JavaScript.</h3>
    </section>

    <section data-background="img/web_isnt_uniform.png" data-background-size="contain"></section>

    <section data-background="img/no_js.png" data-background-size="contain"></section>

    <section data-background="img/everyone_has_js.png" data-background-size="contain"></section>

    <section>
      <img class="no-border" src="img/github1.png"/>
    </section>

    <section>
      <img class="no-border" src="img/github2.png"/>
    </section>

    <section>
      <img class="no-border" src="img/tomdale.png"/>
    </section>

    <section>
      <blockquote class="speech bubble">
        Smartphones are becoming more pervasise than connectivity.
        When you have a supercomputer in your pocket, but intermittent connectivity, the ability to work <strong>offline</strong>
        is the key to ubiquity.
      </blockquote>
      <div class="text-muted">
        <em>– Tom Dale</em>
      </div>
    </section>

    <section>
      <h3>Progressive rendering</h3>
    </section>

    <section data-background="img/aerotwist.png" data-background-size="contain"></section>

    <section>
      <h3>JS frameworks embracing progressive rendering</h3>
      <ul>
        <li>FastBoot (Ember)</li>
        <li>Server-side React</li>
        <li>Angular 2 isolated renderer</li>
        <li>PRPL (Polymer)</li>
        <li>etc.</li>
      </ul>
    </section>

    <section>
      <video src="vid/2g.mp4" height="750" style="transform:translateY(-5%);" muted></video>
    </section>

    <section>
      <h2>&#x1F419; Multithreaded</h2>
    </section>

    <section>
      <h3>Why multithread? Because <em>jank</em>.</h3>
    </section>

    <section>
      <video id="zeldaVid" src="vid/zelda2.mp4" height="650" style="transform:translateY(-10%);" muted></video>
      <button type="button"
              style="position:absolute;top:0;right:0;padding:7px 10px 5px;margin:10px;display:block;font-size:32px;cursor:pointer;"
              onclick="zeldaVid.muted = !zeldaVid.muted">&#x1F50A;</button>
    </section>

    <!--<section>
      <video muted src="vid/floydophone.mp4" height="650"></video>
      <div class="footer muted">Source: <a href="https://twitter.com/floydophone/status/764244080800829440">Pete Hunt on Twitter</a></div>
    </section>-->

    <section>
      <video muted src="vid/kirby_3.mp4" height="650"></video>
    </section>

    <section>
      <img class="no-border" src="img/jeff_atwood.png" alt="Jeff Atwood, state of JS performance is poor"/>
      <div class="footer text-muted">
        Source: https://meta.discourse.org/t/the-state-of-javascript-on-android-in-2015-is-poor/33889
      </div>
    </section>

    <section>
      <div style="position:relative;left: 0; top: 0;">
        <img class="no-border" style="z-index: 1;" src="img/phones.png"/>
        <div class="fragment" style="text-align:center;z-index: 2;position:absolute;top:0;left:0;right:0;bottom:0;">
          <img class="no-border" style="" src="img/phones-overlay.png"/>
        </div>
      </div>
      <div class="footer text-muted" style="transform:translateY(-5px);">
        Source: T-Mobile
      </div>
    </section>

    <section>
      <video src="vid/scroll_jank.mp4" height="700" style="transform:translateY(-5%)" muted></video>
      <div class="footer text-muted" style="transform:translateY(-5px);">
        Source: <a href="https://www.youtube.com/watch?v=NPM6172J22g">Rick Byers</a>
      </div>

    </section>
        <section>
          <h3>Web workers</h3>
          <div style="display:flex;flex-direction:row;">
            <div style="flex-grow: 1; flex-shrink: 1">
          <pre><code class="javascript">// index.js

var worker = new Worker('worker.js');
worker.postMessage('ping');
worker.onmessage = function (e) {
  console.log(e.data); // 'pong'
};</code></pre>
            </div>

            <div style="flex-grow: 1; flex-shrink: 1;">
          <pre><code class="javascript">// worker.js

self.onmessage = function (e) {
  console.log(e.data); // 'ping'
  self.postMessage('pong');
};</code></pre>
</div>
          </div>
        </section>

    <section data-background="img/pokedex_architecture.png" data-background-size="contain">
    </section>

    <section>
      <video height="650" src="vid/react_worker.mp4" muted></video>
    </section>

    <section>
      <img src="img/evan_you.png" class="no-border"/>
      <div class="footer text-muted" style="transform:translateY(-5px);">
        Source: <a href="https://www.youtube.com/watch?v=Ag-1wmHWwS4">Evan You: Demystifying Frontend Framework Performance</a>
      </div>
    </section>

    <section>
      <blockquote class="speech bubble">
        The gain is pretty marginal... and it just adds a lot of development complexity. This is
        probably the reason we haven't seen web worker-based rendering architecture widely used in real apps.
      </blockquote>
      <div class="text-muted">
        <em>– Evan You</em>
      </div>
    </section>
    
    <section data-background="img/html5workertest.png" data-background-size="contain">
    </section>
<section>
  <h3>One solution: promise-worker</h3>
          <div style="display:flex;flex-direction:row;">
            <div style="flex-grow: 1; flex-shrink: 1">
          <pre><code class="javascript">// index.js
var pw = new PromiseWorker(
  new Worker('worker.js'));
pw.postMessage('yo').then(supports => {
  if (!supports) {
    // fall back to worker polyfill
  }
});
</code></pre>

            </div>

            <div style="flex-grow: 1; flex-shrink: 1;">
          <pre><code class="javascript">// worker.js
registerPromiseWorker(msg => {
  return !!self.indexedDB;
});</code></pre>
</div>
</div>
  <div class="footer text-muted">
    Source: <a href="https://github.com/nolanlawson/promise-worker">promise-worker</a>
  </div>
</section>
    <section>
      <h3>Another possible solution: Task Worklets</h3>
      <pre><code class="javascript">registerTaskHandler('NetworkFetcher', class {

  @expose async request(url) {
     return doPostProcessing(await fetch(url));
  }

  doPostProcessing(imgData) {
    /* Convert to grayscale or something expensive */
  }
}</code></pre>
      <div class="text-muted footer">
        Source: <a href="https://docs.google.com/document/d/1yM1Nd7qaqVxsRGDWeHR7OpZPCngtFa_KH5JQ6EjDmAc/edit">
        Ian Kilpatrick</a>
      </div>
    </section>

    <section>
      <h2>More likely:</h2><h3>Service Worker becomes the new Web Worker</h3>
    </section>

    <section>
      <div style="margin:0 auto;position:relative;width:800px;height:600px;">
        <img class="no-border" src="img/ww_vs_sw1-flattened.png" style="position:absolute;top:0;left:0;right:0;bottom:0"/>
        <img class="no-border fragment" src="img/ww_vs_sw2-flattened.png" style="position:absolute;top:0;left:0;right:0;bottom:0"/>
        <img class="no-border fragment" src="img/ww_vs_sw3-flattened.png" style="position:absolute;top:0;left:0;right:0;bottom:0"/>
        <img class="no-border fragment" src="img/ww_vs_sw4-flattened.png" style="position:absolute;top:0;left:0;right:0;bottom:0"/>
        <img class="no-border fragment" src="img/ww_vs_sw5-flattened.png" style="position:absolute;top:0;left:0;right:0;bottom:0"/>
        <img class="no-border fragment" src="img/ww_vs_sw6-flattened.png" style="position:absolute;top:0;left:0;right:0;bottom:0"/>
      </div>
    </section>

    <section>
      <img src="img/caniuse_sw.png" class="no-border"/>
    </section>

    <section>
      <img src="img/bahmutov1.png" style="display:block;margin: 10px auto;"/>
      <img src="img/bahmutov2.png" style="display:block;margin: 10px auto;"/>
    </section>

    <section>
      <img class="no-border" src="img/mvc01.png"/>
    </section>

    <section>
      <img class="no-border" src="img/mvc02.png"/>
    </section>

    <section>
      <h3>What about progressive rendering?</h3>
    </section>

    <section>
      <img class="no-border" src="img/mvc03.png"/>
    </section>

    <section>
      <img class="no-border" src="img/mvc04.png"/>
    </section>

    <section>
      <img src="img/tweet_jaffa.png"/>
      <div class="footer muted">Source: <a href="https://twitter.com/jaffathecake/status/707954036167852032">Jake Archibald</a></div>
    </section>

    <section>
      <h3>New superpowers for the web</h3>
      <ul>
        <li class="fragment">&#x1f4f6; Offline</li>
        <li class="fragment">&#x1F4C8; Progressive</li>
        <li class="fragment">&#x1F419; Multithreaded</li>
      </ul>
    </section>

    <section>
      <h2 class="random-color">Thank you!</h2>
    </section>

    <section>
      <h3>Sources</h3>
      <ul>
        <li>
      <a href="https://www.flickr.com/photos/juergo/14488477365/in/photolist-o5iexT-dNntQG-9D2fSJ-cRYrzm-rYa3oE-9D2gmf-9CYkPe-9D2gWJ-rHRAvC-9H4JPr-dppe69-dppd89-926UvM-dNntjS-dppcLh-dpp4GX-dppdf1-dppf23-boVvSK-7GYniC-9H4K1Z-5RPb7F-dpp7np-qvzSnJ-9pxEBx-gnpTaP-dppdFN-zSSAuL-7GYkBU-f4U7fq-fL6h8W-926Uz6-gnpBzE-9F4XBD-926UC4-dpp4PB-dppeVo-boVvyx-dpp67R-boVwtp-boVUNF-hxyJ7n-boVVmX-boVV5H-8GRfja-dpp7LF-dppe1b-92a33W-6kem38-gnpYus">Hype train (Flickr)</a></li>
          <li><a href="http://www.lukew.com/ff/entry.asp?1954">Mobile Web vs. Native Apps or Why You Want Both</a></li>
        <li><a href="https://www.youtube.com/watch?v=x7cfLDFVyHo">Alex Russell: Progressive Web Apps (video)</a></li>
        <li><a href="https://www.reddit.com/r/javascript/comments/3v7uei/state_of_the_web_and_javascript/?st=itrrjutb&sh=b31a936d">Sylvain Galineau comment (original tweet deleted)</a></li>
        <li><a href="https://adactio.com/journal/10708">Regressive web apps</a></li>
        <li><a href="https://medium.com/@fox/the-web-isn-t-uniform-fd67eb631501">The web isn't uniform</a></li>
        <li><a href="http://kryogenix.org/code/browser/everyonehasjs.html">Everyone has JavaScript, right?</a></li>
        <li><a href="https://www.youtube.com/watch?v=puOrC7cfjRI">Tom Dale: Responsive Field Day 2015</a></li>
        <li><a href="https://twitter.com/aerotwist/status/729712502943174657">Paul Lewis on progressive rendering</a></li>
        <li><a href="http://www.pocketjavascript.com/blog/2015/11/23/introducing-pokedex-org">Introducing Pokedex.org</a></li>
        <li><a href="http://blog.nparashuram.com/2015/12/react-web-worker-renderer.html">React Web Worker Renderer</a></li>
        <li><a href="http://html5workertest.com">HTML5WorkerTest.com</a></li>
        <li><a href="https://glebbahmutov.com/blog/run-express-server-in-your-browser/">Run Express server in your browser</a></li>
        <li><a href="https://github.com/bahmutov/babel-service">babel-service</a></li>
      </ul>
    </section>

  </div>
</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.min.js"></script>
<script src="js/jquery-1.9.1.js"></script>
<script src="js/randomColor.js"></script>
<script src="js/highcharts.js"></script>
<script src="js/highcharts-exporting.js"></script>

<script>
  // Full list of configuration options available here:
  // https://github.com/hakimel/reveal.js#configuration
  Reveal.initialize({
    width: '99%',
    height: '99%',
    controls: true,
    progress: true,
    history: true,
    center: true,
    fragments: true,

    theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
    transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/fade/none
    backgroundTransition: Reveal.getQueryHash().transition || 'none',

    // Parallax scrolling
    // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
    // parallaxBackgroundSize: '2100px 900px',

    // Optional libraries used to extend on reveal.js
    dependencies: [
      { src: 'plugin/highlight/highlight.js', async: true, callback: function () { hljs.initHighlightingOnLoad(); } }
    ]
  });

  function playVideo () {
    var videos = Array.from(
        document.querySelectorAll('section.present video'));
    videos.forEach(function (vid) {
      vid.loop = true;
      vid.currentTime = 0;
      vid.play();
    });

    var otherVideos = Array.from(document.querySelectorAll('section.past video')).concat(
        Array.from(document.querySelectorAll('section.future video')));
    otherVideos.forEach(function (vid) {
      if (!vid.paused) {
        vid.pause();
      }
    });
  }

  var randomizedTextTimeout;

  function randomizeText(slide) {
    var rando = slide.querySelector('.random-color');
    if (rando) {
      randomizedTextTimeout = setInterval(function () {
        requestAnimationFrame(function () {
          if (!rando.dataset.colorized) {
            var text = rando.innerText;
            var newText = '';
            for (var i = 0; i < text.length; i++) {
              newText += '<span style="color:' + randomColor() + '">' + text.charAt(i) + '</span>';
            }
            rando.innerHTML = newText;
            rando.dataset.colorized = true;
          } else {
            var spans = rando.querySelectorAll('span');
            for (var i = 0; i < spans.length; i++) {
              spans[i].style.color = randomColor();
            }
          }
        });
      }, 100);
    }
  }

  Reveal.addEventListener('slidechanged', function (event) {
    // event.previousSlide, event.currentSlide, event.indexh, event.indexv
    var notes = event.currentSlide.querySelector(".notes");
    if (notes) {
      console.info(notes.innerHTML.replace(/\n\s+/g, '\n'));
    }

    requestAnimationFrame(function () {
      clearInterval(randomizedTextTimeout);
      randomizeText(event.currentSlide);
      requestAnimationFrame(playVideo);
    });
  });

  Reveal.addEventListener('fragmentshown', function (e) {
    // show the animations
    $(e.target).find('li span').each(function (i, el) {
      $(el).addClass('anim' + (i + 1));
    });
  });

  Reveal.addEventListener('fragmenthidden', function (e) {
    // hide the animations
    $(e.target).find('li span').each(function (i, el) {
      $(el).removeClass('anim' + (i + 1));
    });
  });

  // log the first slide's notes as well
  var notes = document.querySelector('section.present aside.notes');
  if (notes) {
    console.info(notes.innerHTML.replace(/\n\s+/g, '\n'));
  }

  playVideo();
  randomizeText(document.querySelector('section.present'));

</script>

</body>
</html>
